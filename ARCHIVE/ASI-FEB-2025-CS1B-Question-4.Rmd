### Solution to Question 4: Bayesian Analysis of an Exponential Distribution

This exercise demonstrates a **Bayesian approach** to statistical inference. The goal is to update a prior belief about a parameter (in this case, the rate parameter $\\theta$ of an exponential distribution) using new data.

-----

### i) Posterior Distribution Parameters

Given a sample from an exponential distribution, $Y\_i \\sim \\text{Exp}(\\theta)$, and a prior distribution for $\\theta$ which is a Gamma distribution, $\\theta \\sim \\text{Gamma}(\\alpha, \\beta)$, the posterior distribution for $\\theta$ is also a Gamma distribution.

The parameters of the posterior distribution are:

  * **Shape parameter:** $\\alpha\_{posterior} = \\sum\_{i=1}^n Y\_i + \\alpha$
  * **Rate parameter:** $\\beta\_{posterior} = n + \\beta$

In this problem, the prior distribution is $\\text{Gamma}(1, 0.5)$ (or $\\alpha=1, \\beta=0.5$), and the sample size is $n=30$.
Therefore, the posterior distribution is $\\text{Gamma}(\\sum\_{i=1}^{30} Y\_i + 1, 30 + 0.5)$.

-----

### ii) Plotting the Prior Distribution

The prior distribution for $\\theta$ is assumed to be an exponential distribution with a rate of 0.5. An exponential distribution is a special case of the Gamma distribution with a shape parameter of 1.

The code plots the probability density function of the prior distribution.

```r
theta <- seq(0, 6.8, by = 0.01)

# Plotting the prior density function (dexp is a special case of dgamma where shape=1)
plot(theta, dexp(theta, 0.5), type = "l", ylab = "Density", ylim = c(0, 1), xlab = "theta", main = "Prior and Posterior Distributions")
```

The plot shows a downward-sloping curve, representing the initial belief about the distribution of $\\theta$ before observing any data.

-----

### iii) Plotting the Posterior Distribution

Next, the data `y` is introduced to update the prior belief. The posterior distribution is then calculated and plotted on the same graph as the prior.

```r
y <- c(5, 5, 6, 2, 4, 10, 2, 5, 5, 2, 5, 3, 7, 4, 4, 5, 4, 6, 7, 2, 8, 4, 6, 4, 3, 6, 6, 6, 5, 7)

# Calculate the sum of the observations
sum_y <- sum(y) # sum_y is 154

# Plot the posterior density function on the same graph
lines(theta, dgamma(theta, sum_y + 1, 30 + 0.5), col = "red")
```

The posterior distribution is a Gamma distribution with a shape of $154 + 1 = 155$ and a rate of $30 + 0.5 = 30.5$.

-----

### iv) Comparison of Prior and Posterior Distributions

The posterior density curve is a sharp, bell-shaped curve that is significantly different from the prior's downward-sloping curve. The posterior distribution has a peak (or mode) around a specific value of $\\theta$, and its density is concentrated in a much narrower range. This indicates that:

  * The data has provided a great deal of information about the true value of $\\theta$.
  * The posterior distribution is now dominated by the **likelihood** of the data, rather than the initial prior belief. This shows that the initial belief has been heavily updated by the evidence from the 30 observations.

-----

### v) Constructing a Credible Interval

A **credible interval** is a Bayesian equivalent of a confidence interval. It represents a range of values within which the parameter is believed to fall with a certain probability. The 90% equal-tailed credible interval is calculated using the quantile function of the posterior Gamma distribution.

```r
qgamma(c(0.05, 0.95), sum(y) + 1, 30 + 0.5)
```

The resulting 90% credible interval is **(4.246, 5.562)**. This means there is a 90% probability that the true value of the rate parameter $\\theta$ lies within this range, according to the model.

-----

### vi) Calculating Posterior Probability

The final step is to calculate the probability that the rate parameter $\\theta$ is greater than 5, based on the posterior distribution.

```r
1 - pgamma(5, sum(y) + 1, 30 + 0.5)
```

The calculated posterior probability is **0.3776**. This means there is a 37.76% chance that the true value of $\\theta$ is greater than 5.