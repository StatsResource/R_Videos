<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Statistics with R</title>
    <meta charset="utf-8" />
    <script src="libs/header-attrs-2.29/header-attrs.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Statistics with R
]
.subtitle[
## Introduction to R for Actuarial Students
]

---







---

## üìò Overview

- Introduction to R for Actuarial Students  
- CS1B Curriculum  
- R Programming Basics  
- Fundamentals of Statistical Analysis  
- Question 1  

---

## ‚ùì Question 4

The table below shows the total number of claims (cancellations) per year \( X_{ij} \) for four travel companies over the last four years.

| Company | Year 1 | Year 2 | Year 3 | Year 4 |
|--------|--------|--------|--------|--------|
| Make   | 455    | 458    | 587    | 531    |
| Ease   | 251    | 322    | 292    | 340    |
| Go     | 309    | 246    | 217    | 120    |
| Clear  | 400    | 426    | 470    | 547    |

---

### (i) EBCT Model 1 Calculations

**a)** Load the data:


``` r
q4 &lt;- matrix(c(
  455, 251, 309, 400,
  458, 322, 246, 426,
  587, 292, 217, 470,
  531, 340, 120, 547
), ncol = 4, nrow = 4)
```

**b)** \( E[m(\theta)] \)


``` r
m &lt;- mean(rowMeans(q4))
m
```

```
## [1] 373.1875
```

**c)** \( E[s^2(\theta)] \)


``` r
s &lt;- mean(apply(q4, 1, var))
s
```

```
## [1] 3967.854
```

**d)** \( \text{Var}[m(\theta)] \)


``` r
v &lt;- var(rowMeans(q4)) - mean(apply(q4, 1, var)) / ncol(q4)
v
```

```
## [1] 16843.22
```

**e)** Credibility factor \( Z \)


``` r
n &lt;- ncol(q4)
Z &lt;- n / (n + s / v)
Z
```

```
## [1] 0.9443816
```

---

### (ii) Expected Claims for Go and Clear


``` r
Z * rowMeans(q4[3:4,]) + (1 - Z) * m
```

```
## [1] 231.3532 455.8799
```

---

### (iii) Additional Info for EBCT Model 2

&gt; Risk volumes are required to apply EBCT Model 2.

---

### (iv) Goodness-of-Fit Test for Binomial Model

Travel company **Ease** launched a membership program last year offering full refunds on cancellations. Cancellations are believed to follow a binomial distribution with parameters \( n = 3 \), \( p = 0.20 \).

| Cancellations | Members |
|---------------|---------|
| 0             | 61      |
| 1             | 71      |
| 2             | 15      |
| 3             | 3       |

**Combine 2 and 3 (due to low frequency):**


``` r
obs &lt;- c(61, 71, 15 + 3)
p &lt;- 0.2
exp &lt;- dbinom(0:1, 3, p)
exp[3] &lt;- 1 - pbinom(1, 3, p)
chisq.test(x = obs, p = exp)
```

```
## 
## 	Chi-squared test for given probabilities
## 
## data:  obs
## X-squared = 6.7371, df = 2, p-value = 0.03444
```

&gt; Since p-value &lt; 0.05, we reject the null hypothesis that cancellations follow Bin(3, 0.2).

---

## üìö EBCT Model 1 Summary

Empirical Bayes Credibility Theory (EBCT) Model 1, developed by Hans B√ºhlmann (1967), estimates a credibility premium by blending individual and group-level risk data.

### Key Concepts

- **Assumptions**: Observed data follows a distribution with random parameters  
- **Credibility Factor \( Z \)**: Balances individual vs. group experience  
- **Formula**:
  $$
  \text{Credibility Premium} = Z \cdot \text{Individual Mean} + (1 - Z) \cdot \text{Overall Mean}
  $$
- **Applications**: Used in insurance pricing and risk assessment

---

## üìé References

1. [MTH5131 Actuarial Statistics ‚Äì Queen Mary University of London](https://qmplus.qmul.ac.uk/mod/resource/view.php?id=2522684)  
2. [Risk Modelling in General Insurance ‚Äì Cambridge University Press](https://assets.cambridge.org/97805218/63940/index/9780521863940_index.pdf)  
3. [Credibility Theory Lecture Notes ‚Äì Studocu](https://www.studocu.com/in/document/universal-business-school/statistics/5-credibility-theory-lecture-notes-1/16670923)  
4. [Credibility Premium Estimation ‚Äì IDEAS/RePEc](https://ideas.repec.org/p/hal/wpaper/hal-01855972.html)

---

Let me know if you'd like this converted into a presentation or exported to another format.
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
