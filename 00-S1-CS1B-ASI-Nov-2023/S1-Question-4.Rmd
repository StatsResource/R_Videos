---
title: "Statistics with R"
subtitle: "Introduction to R for Actuarial Students"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    lib_dir: libs
    nature:
      highlightStyle: github
      countIncrementalSlides: false
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(magrittr)
library(knitr)
library(dplyr)
library(janitor)
```

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)
style_mono_accent_inverse(
  base_color = "#1c5253",
  header_font_google = google_font("Josefin Sans"),
  text_font_google   = google_font("Montserrat", "300", "300i"),
  code_font_google   = google_font("Fira Mono")
)
```

---

## üìò Overview

- Introduction to R for Actuarial Students  
- CS1B Curriculum  
- R Programming Basics  
- Fundamentals of Statistical Analysis  
- Question 1  

---

## ‚ùì Question 4

The table below shows the total number of claims (cancellations) per year \( X_{ij} \) for four travel companies over the last four years.

| Company | Year 1 | Year 2 | Year 3 | Year 4 |
|--------|--------|--------|--------|--------|
| Make   | 455    | 458    | 587    | 531    |
| Ease   | 251    | 322    | 292    | 340    |
| Go     | 309    | 246    | 217    | 120    |
| Clear  | 400    | 426    | 470    | 547    |

---

### (i) EBCT Model 1 Calculations

**a)** Load the data:

```{r}
q4 <- matrix(c(
  455, 251, 309, 400,
  458, 322, 246, 426,
  587, 292, 217, 470,
  531, 340, 120, 547
), ncol = 4, nrow = 4)
```

**b)** \( E[m(\theta)] \)

```{r}
m <- mean(rowMeans(q4))
m
```

**c)** \( E[s^2(\theta)] \)

```{r}
s <- mean(apply(q4, 1, var))
s
```

**d)** \( \text{Var}[m(\theta)] \)

```{r}
v <- var(rowMeans(q4)) - mean(apply(q4, 1, var)) / ncol(q4)
v
```

**e)** Credibility factor \( Z \)

```{r}
n <- ncol(q4)
Z <- n / (n + s / v)
Z
```

---

### (ii) Expected Claims for Go and Clear

```{r}
Z * rowMeans(q4[3:4,]) + (1 - Z) * m
```

---

### (iii) Additional Info for EBCT Model 2

> Risk volumes are required to apply EBCT Model 2.

---

### (iv) Goodness-of-Fit Test for Binomial Model

Travel company **Ease** launched a membership program last year offering full refunds on cancellations. Cancellations are believed to follow a binomial distribution with parameters \( n = 3 \), \( p = 0.20 \).

| Cancellations | Members |
|---------------|---------|
| 0             | 61      |
| 1             | 71      |
| 2             | 15      |
| 3             | 3       |

**Combine 2 and 3 (due to low frequency):**

```{r}
obs <- c(61, 71, 15 + 3)
p <- 0.2
exp <- dbinom(0:1, 3, p)
exp[3] <- 1 - pbinom(1, 3, p)
chisq.test(x = obs, p = exp)
```

> Since p-value < 0.05, we reject the null hypothesis that cancellations follow Bin(3, 0.2).

---

## üìö EBCT Model 1 Summary

Empirical Bayes Credibility Theory (EBCT) Model 1, developed by Hans B√ºhlmann (1967), estimates a credibility premium by blending individual and group-level risk data.

### Key Concepts

- **Assumptions**: Observed data follows a distribution with random parameters  
- **Credibility Factor \( Z \)**: Balances individual vs. group experience  
- **Formula**:
  $$
  \text{Credibility Premium} = Z \cdot \text{Individual Mean} + (1 - Z) \cdot \text{Overall Mean}
  $$
- **Applications**: Used in insurance pricing and risk assessment

---

---

## üìé References

1. [MTH5131 Actuarial Statistics ‚Äì Queen Mary University of London](https://qmplus.qmul.ac.uk/mod/resource/view.php?id=2522684)  
2. [Risk Modelling in General Insurance ‚Äì Cambridge University Press](https://assets.cambridge.org/97805218/63940/index/9780521863940_index.pdf)  
3. [Credibility Theory Lecture Notes ‚Äì Studocu](https://www.studocu.com/in/document/universal-business-school/statistics/5-credibility-theory-lecture-notes-1/16670923)  
4. [Credibility Premium Estimation ‚Äì IDEAS/RePEc](https://ideas.repec.org/p/hal/wpaper/hal-01855972.html)

---

Let me know if you'd like this converted into a presentation or exported to another format.