<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Statistics with R</title>
    <meta charset="utf-8" />
    <script src="libs/header-attrs-2.29/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Statistics with R
]
.subtitle[
## Introduction to R for Actuarial Students
]

---




&lt;style type="text/css"&gt;
pre {
  background: #ADD8E6;
  max-width: 100%;
  overflow-x: scroll;
}
&lt;/style&gt;

* Introduction to R for Actuarial Students

* CS1B Curriculum

* Introduction to R programming
* Fundamentals of Statistical Analysis

* Question 1

---

Thanks, Kevin â€” hereâ€™s a cleaned-up and well-structured version of your solution for **Solution 2**, formatted for clarity and consistency in R Markdown style:

---

## ðŸ§® Solution 2

### (i) Load Data and Compute Mean

```r
Sales &lt;- read.csv("SalesData.csv") 
mean(Sales$Value)
```

**Output**:  
`[1] 1307.167`

---

### (ii) Correlation and Covariance

**(a) Kendall correlation between Value and City**

```r
cor(Sales$Value, Sales$City, method = "kendall")
```

**(b) Covariance between Value and Age**

```r
r &lt;- cor(Sales$Value, Sales$Age)
r * sd(Sales$Value) * sd(Sales$Age)
```

**Alternate:**

```r
cov(Sales$Value, Sales$Age)
```

---

### (iii) Scatterplot and Correlation Test

**(a) Scatterplot of Value vs Age**

```r
plot(Sales$Value, Sales$Age)
```

- No clear linear trend observed  
- Suggests correlation is close to zero

**(b) Pearson correlation test**

```r
cor.test(Sales$Value, Sales$Age)
```

- Correlation: `-0.1241`  
- 95% CI: `(-0.367, 0.134)`  
- p-value: `0.3447`  
- Conclusion: Cannot reject the null hypothesis that correlation = 0

---

### (iv) Linear Regression Models

**(a) Age can be excluded due to weak correlation**

**(b) Fit full model with Device, City, Age**

```r
model1 &lt;- lm(Value ~ Device + City + Age, data = Sales)
summary(model1)
```

- DeviceMobile is significant (p &lt; 0.001)  
- City and Age are not significant (p &gt; 0.05)

**(c) Compare with reduced model**

```r
model2 &lt;- lm(Value ~ Device, data = Sales)
anova(model1, model2)
```

- p-value = `0.07838`  
- Conclusion: Cannot reject Hâ‚€ that City and Age coefficients are zero

**(d) Summary of reduced model**

```r
summary(model2)
```

- Equation: `Value = 2056.47 - 1045.54 Ã— Device`  
- Adjusted RÂ²: `0.5976`  
- DeviceMobile is significant

---

### (v) Confidence Intervals

**(a) Coefficients**

```r
confint(model2, level = 0.95)
```

- DeviceMobile CI: `(-1267.86, -823.23)`

**(b) Residual variance CI**

```r
residual &lt;- model2$residuals
n &lt;- length(residual)
varhat &lt;- var(residual)
(n - 2) * varhat / qchisq(c(0.975, 0.025), 58)
```

- CI: `(105867, 220588)`

---

### (vi) Poisson Fit for Order Variable

**(a) Mean of Order**

```r
m &lt;- mean(Sales$Order)
```

- Î¼Ì‚ = `2.383`

**(b) Frequency table**

```r
table(Sales$Order)
```

**(c) Goodness-of-fit test**

```r
a &lt;- as.numeric(table(Sales$Order))
a[6] &lt;- sum(a[6:7])
a &lt;- a[-7]
e &lt;- dpois(0:4, m)
e[6] &lt;- 1 - sum(e)
chisq.test(x = a, p = e)
```

- p-value = `0.306`  
- Conclusion: Cannot reject null hypothesis that Order follows Poisson distribution

---

### (vii) Poisson GLM for Order ~ Device

**(a) Fit model**

```r
glm2 &lt;- glm(Order ~ Device, family = poisson(link = "log"), data = Sales)
summary(glm2)
```

- DeviceMobile is significant (p &lt; 0.001)  
- AIC: `199.88`

**(b) Log link explanation**

- Log link ensures Î¼ = exp(linear predictor), keeping Î¼ &gt; 0  
- Essential for Poisson models

---

### (viii) Predictions

**(a) Predict for new customers**

```r
Customers &lt;- data.frame(Device = c("Mobile", "Mobile"), Age = c(18, 28), City = c(1, 2))
predict(glm2, newdata = Customers, type = "response")
```

- Predicted Order: `3`, `3` (same due to identical Device)

**(b) Explanation**

- Only Device used in model â†’ same prediction for both

---

### (ix) Total Value Prediction

```r
Channel &lt;- data.frame(Device = c("Mobile", "Laptop"))
pred_order &lt;- predict(glm2, newdata = Channel, type = "response")
pred_value &lt;- predict(model2, newdata = Channel)
totalvalue &lt;- pred_order * pred_value
totalvalue
```

- Mobile: `3032.79`  
- Laptop: `1693.56`

---


Solution 2:
i) i
.

``` r
Sales&lt;-read.csv("SalesData.csv") 
mean(Sales$Value)
```

```
## [1] 1307.167
```


[1] 1307.167
(1)
[2]
ii) i
a) a
.

---


``` r
cor(Sales$Value,Sales$City,method = "kendall")
```

```
## [1] -0.2130327
```

[1]
b) b
.


``` r
r &lt;-cor(Sales$Value,Sales$Age)
r*sd(Sales$Value)*sd(Sales$Age)
```

```
## [1] -278.5169
```

[1] -278.5169

---

Alternate:

``` r
cov(Sales$Value,Sales$Age)
```

```
## [1] -278.5169
```

Credit is given if Kendall covariance is computed.
(1.5)

---

iii) i
a) a
.


``` r
plot(Sales$Value,Sales$Age) 
```

![](Q1-Question-2_files/figure-html/unnamed-chunk-6-1.png)&lt;!-- --&gt;


---

(1)

* No trend (showing linear relationship) is visible from the scatter plot.
* Most likely it indicates that correlation is zero.

b) b
.

---


``` r
cor.test(Sales$Value,Sales$Age)
```

```
## 
## 	Pearson's product-moment correlation
## 
## data:  Sales$Value and Sales$Age
## t = -0.95277, df = 58, p-value = 0.3447
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.3665088  0.1340120
## sample estimates:
##        cor 
## -0.1241369
```


Pearson's product-moment correlation
data: Sales$Value and Sales$Age
t = -0.95277, df = 58, p-value = 0.3447
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
-0.3665088 0.1340120
sample estimates:
 cor 
-0.1241369
(1)
(1) 
for CI

---

Confidence Interval is ( -0.367,0.134)
Since 0 lies in the confidence interval, we cannot reject the hypothesis that correlation coefficient 
= 0. 
(1)

---

iv)
a) Since correlation between Value and Age is (close to) 0, age can be excluded. a (2)
b) b
.



``` r
model1&lt;-lm(data = Sales,Value~Device+City+Age)
summary(model1)
```

```
## 
## Call:
## lm(formula = Value ~ Device + City + Age, data = Sales)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -768.21 -239.97  -19.05  236.74  959.32 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   2887.26     378.29   7.632 3.12e-10 ***
## DeviceMobile -1022.97     110.18  -9.284 6.28e-13 ***
## City          -135.98     100.03  -1.359   0.1795    
## Age            -26.25      13.41  -1.958   0.0552 .  
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 377 on 56 degrees of freedom
## Multiple R-squared:  0.6388,	Adjusted R-squared:  0.6195 
## F-statistic: 33.01 on 3 and 56 DF,  p-value: 2.019e-12
```

---

Call:
lm(formula = Value ~ Device + City + Age, data = Sales)
Residuals:
 Min 1Q Median 3Q Max 
-768.21 -239.97 -19.05 236.74 959.32 
Coefficients:
 Estimate Std. Error t value Pr(&gt;|t|) 
(Intercept) 2887.26 378.29 7.632 3.12e-10 ***
DeviceMobile -1022.97 110.18 -9.284 6.28e-13 ***
City -135.98 100.03 -1.359 0.1795 
Age -26.25 13.41 -1.958 0.0552 . 
---
Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1
(1)
(1)

---

Residual standard error: 377 on 56 degrees of freedom
Multiple R-squared: 0.6388, Adjusted R-squared: 0.6195 
F-statistic: 33.01 on 3 and 56 DF, p-value: 2.019e-12
Device = 1 for Mobile and 0 for Laptop. Parameter for this variable is significant.
Alternate : Device is significant
Age and City are not significant â€¦
â€¦â€¦.since p-value &gt; 0.05. 
Age is expected to insignificant per the earlier analysis.
(0.5)
(1)

---

c) c
.
model2&lt;-lm(data = Sales,Value~Device)
&gt; 
&gt; anova(model1,model2)
Analysis of Variance Table
Model 1: Value ~ Device + City + Age
Model 2: Value ~ Device
 Res.Df RSS Df Sum of Sq F Pr(&gt;F) 
1 56 7958529 
2 58 8716151 -2 -757622 2.6655 0.07838 .
---
Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1
(1)
(1)
H0: Î² (City) = Î² (Age) =0 against H1: atleast one of Î² (City) or Î² (Age) is non-zero.
In model 2, there are 2 less parameters thus -2 degrees of freedom in Anova analysis
p-value &gt;0.05 showing we canâ€™t reject H0: Î² (City) = Î² (Age) =0. 
This indicates neither of the covariates have strong relationship with Order value. 

---

d) d
.
summary(model2)
Call:
lm(formula = Value ~ Device, data = Sales)
Residuals:
 Min 1Q Median 3Q Max 
-810.9 -240.1 -8.7 271.6 889.1 
Coefficients:
 Estimate Std. Error t value Pr(&gt;|t|) 
(Intercept) 2056.47 94.02 21.873 &lt; 2e-16 ***
DeviceMobile -1045.54 111.06 -9.414 2.77e-13 ***
---
Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1
Residual standard error: 387.7 on 58 degrees of freedom
Multiple R-squared: 0.6044, Adjusted R-squared: 0.5976 
F-statistic: 88.62 on 1 and 58 DF, p-value: 2.77e-13
&gt; # Value = 2056.47 - 1045.54 X Device, 
 where Device= 1 for Mobile else 0
Alternate:
&gt; # Value = 2056.47 - 1045.54 X Device Mobile 

---

v) .
a) a
.
confint(model2,level=.95)
 2.5 % 97.5 %
(Intercept) 1868.268 2244.6737
DeviceMobile -1267.855 -823.2257
&gt; # C.I. (-1267.8,-823.2)
(1)
(1)
[2]
b) b
.
&gt; residual&lt;-model2$residuals
&gt; n&lt;-length(residual)
&gt; varhat&lt;-var(residual)
&gt; (n-2)*varhat/qchisq(c(0.975,.025),58)
[1] 105867.1 220588.2
&gt; # C.I. (105867,220588)

---

vi) .
a) a
.
m&lt;-mean(Sales$Order)
&gt; m
[1] 2.383333
(1)
(1)
 Mu hat = 2.383
[2]
b) b
.
table(Sales$Order)
0 1 2 3 4 5 7 
8 13 13 8 12 5 1
(1)
(1)
[2]
c) c
.
a&lt;-as.numeric(table(Sales$Order))
#using above table, combine order 5 and 5+
a[6]=sum(a[6:7])
a&lt;-a[-7] #to remove 5+ as combine above
e&lt;-dpois(c(0:4),m)
sum(e)
[1] 0.9062099
e[6]&lt;-1 - sum(e)
sum(e)
[1] 1

---
(1)

```
chisq.test(x=a,p=e)

```

Chi-squared test for given probabilities
data: a
X-squared = 6.0026, df = 5, p-value = 0.306
(2)


* Since p-value is greater than 0.05 , we can reject the hypothesis that number of order follows 
poisson distribution.

---

vii) .
a) a
.
glm2&lt;-glm(data=Sales,Order~Device,family=poisson(link="log"))
&gt; summary(glm2)
Call:
glm(formula = Order ~ Device, family = poisson(lin = "log"), 
(2)
(1)

 data = Sales)
Deviance Residuals: 
 Min 1Q Median 3Q Max 
-2.4495 -0.6149 0.0000 0.5491 1.9652 
Coefficients:
 Estimate Std. Error z value Pr(&gt;|z|) 
(Intercept) -0.1942 0.2673 -0.726 0.468 
DeviceMobile 1.2928 0.2814 4.594 4.34e-06 ***
---
Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1
(Dispersion parameter for poisson family taken to be 1)
 Null deviance: 81.185 on 59 degrees of freedom
Residual deviance: 51.570 on 58 degrees of freedom
AIC: 199.88
Number of Fisher Scoring iterations: 5 [3]
b) b
.
Log link function is used in above model. (0.5)
Log link implied log mu = linear predictor. Inverting to mu leads to mu = exp(linear predictor).
Exponent will make sure mu always remain greater than 0, an essential feature for poisson 
distribution with mean mu. (1.5)
[2]
viii) .
a) a
.
Customers&lt;- data.frame(Device =c("Mobile","Mobile"),Age =c(18,28), City = c(1,2))
&gt; predict.glm(glm2,newdata = Customers,type= "response")
1 2 
3 3
(1.5)
(2)
(0.5)
[4]
b) b
.
Only device is used in the model and for both customers, device is same and thus, the predicted 
value is same for both customers. [2]
ix) Channel &lt;-data.frame(Device =c("Mobile","Laptop"))
&gt; pred_order &lt;- predict.glm(glm2,newdata = Channel,type= "response")
&gt; pred_value &lt;- predict(model2,newdata = Channel)
&gt; 
&gt; totalvalue&lt;-pred_order * pred_value
&gt; totalvalue
 1 2 
3032.791 1693.564 
&gt; #total value for Mobile = 3032.8
&gt; # and for Laptop = 1693.6
(1.5)
(1.5)
(1)
(1.5)
(1)
[Max 6]
[61 Marks]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
