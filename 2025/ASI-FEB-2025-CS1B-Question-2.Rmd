Solution to Question 2:
### Solution to Question 2: Regression Analysis of Crop Yield

This exercise uses **regression analysis** to model the relationship between crop yield and several environmental factors. The analysis is performed using R, and it covers simple linear regression, multiple linear regression, and generalized linear models.

#### i) Data Loading and Initial Plot

The analysis begins by loading the `crop_yield.csv` dataset and creating a scatter plot matrix to visualize the relationships between all variables.

```r
library(readr)
crop_yield <- read_csv("D:/CS1B/crop_yield.csv")
plot(crop_yield, main = "Scatter Plot for Crop Yield")
```

#### ii) Correlation Analysis

A Pearson correlation matrix is computed to quantify the linear relationships between all variables.

```r
cor_matrix <- cor(crop_yield, method = "pearson")
print(cor_matrix)
```

**Interpretation of Correlations:**

  * **Crop Yield & Area:** The correlation is extremely high and positive (close to 1). This suggests that as the cultivated area increases, the total crop yield also increases proportionally, which is expected.
  * **Crop Yield & Rainfall:** The correlation is weak and positive (0.13). This indicates that crop yield has a low dependence on rainfall, possibly due to the use of irrigation.
  * **Crop Yield & Groundwater Level:** The correlation is weak and negative (-0.14). This suggests a very weak inverse relationship, where higher groundwater levels are associated with slightly lower yields, also likely due to irrigation practices.
  * **Crop Yield & Soil PH:** The correlation is weak and positive (0.11), indicating a low dependence of crop yield on the soil's pH level.

-----

#### iii) Simple Linear Regression: Rainfall

A simple linear regression model is built to predict `Crop_yield` based on `Rainfall`.

```r
model1 <- lm(crop_yield$Crop_yield ~ crop_yield$Rainfall)
print(model1)
plot(crop_yield$Rainfall, crop_yield$Crop_yield, main = "Rainfall vs. Crop Yield")
abline(model1)
```

The model's coefficients show a small positive relationship, as indicated by the correlation analysis. The plot visually represents this weak linear trend.

-----

#### iv) Hypothesis Testing: Soil PH

A simple linear regression model is created for `Soil_PH` to test if its slope coefficient is significantly different from zero.

  * **Null Hypothesis ($H\_0$):** The slope coefficient ($\\beta$) is equal to 0. Crop yield is independent of soil PH.
  * **Alternative Hypothesis ($H\_1$):** The slope coefficient ($\\beta$) is not equal to 0. Crop yield is not independent of soil PH.

<!-- end list -->

```r
model2 <- lm(crop_yield$Crop_yield ~ crop_yield$Soil_PH)
confint(model2, level = 0.95)
```

The 95% confidence interval for the `Soil_PH` slope coefficient is `[-7773.835, 13833.17]`. Since this interval includes 0, we **do not have sufficient evidence to reject the null hypothesis**. Therefore, we conclude that crop yield is likely independent of soil PH.

-----

#### v) Simple Linear Regression: Groundwater Level

A model is built to predict `Crop_yield` based on `Groundwater_level`. The model is then used to predict crop yield at a groundwater level of zero.

```r
model3 <- lm(crop_yield$Crop_yield ~ crop_yield$Groundwater_level)
CY_at_0 <- model3$coefficients[1] + model3$coefficients[2] * 0
avg_CY <- mean(crop_yield$Crop_yield)
per_chg <- (CY_at_0 - avg_CY) / avg_CY * 100
```

At a groundwater level of zero, the model predicts a crop yield that is **approximately 41% higher** than the average crop yield. This surprising result suggests that the model is not capturing the full picture, and other factors like improved irrigation or technology may be more influential than groundwater level.

-----

#### vi) Inverse Regression: Area

A model is built to predict `Area` based on `Crop_yield`. This is an inverse regression model used to determine the required area to achieve a target crop yield.

```r
model4 <- lm(crop_yield$Area ~ crop_yield$Crop_yield)
area <- model4$coefficients[1] + model4$coefficients[2] * 200000
```

To achieve a target yield of 200,000 units, the model predicts that **714.25 hectares** of land would be needed.

-----

#### vii) Multiple Linear Regression

A multiple linear regression model is built to predict `Crop_yield` using all four independent variables: `Area`, `Rainfall`, `Groundwater_level`, and `Soil_PH`.

```r
model5 <- lm(crop_yield$Crop_yield ~ crop_yield$Area + crop_yield$Rainfall +
               crop_yield$Groundwater_level + crop_yield$Soil_PH)
print(model5)
plot(residuals(model5))
```

The residual plot shows the model's errors, which are ideally randomly scattered around zero.

-----

#### viii) Generalized Linear Model (GLM)

A **Generalized Linear Model (GLM)** with a Gamma distribution and an inverse link function is also fitted to the data. This is an alternative to linear regression when the response variable (crop yield) is positive and skewed.

```r
model6 <- glm(crop_yield$Crop_yield ~ crop_yield$Area + crop_yield$Rainfall +
                crop_yield$Groundwater_level + crop_yield$Soil_PH,
              family = Gamma(link = "inverse"))
print(model6)
```

The GLM provides a different set of coefficients and an AIC value, which can be used to compare it to other models.

-----

#### ix) Model Comparison

The final step compares the performance of the multiple linear regression model (`model5`) and the GLM (`model6`) by predicting the crop yield using the average values of all independent variables.

```r
# Calculate average values for all variables
avg_area <- mean(crop_yield$Area)
# ... other averages

# Predict using the linear model
exp_CY_M5 <- predict(model5, newdata = data.frame(Area = avg_area, Rainfall = avg_rainfall,
                                                     Groundwater_level = avg_gwl, Soil_PH = avg_sph))

# Predict using the GLM
expected_cy_glm <- predict(model6, newdata = data.frame(Area = avg_area, Rainfall = avg_rainfall,
                                                        Groundwater_level = avg_gwl, Soil_PH = avg_sph),
                           type = "response")
```

**Conclusion:** The multiple linear regression model's prediction (`11835.77`) is very close to the actual average crop yield (`11835.77`). In contrast, the GLM's prediction (`8226.56`) is not. This suggests that the **multiple linear regression model is a better fit** for this specific dataset.