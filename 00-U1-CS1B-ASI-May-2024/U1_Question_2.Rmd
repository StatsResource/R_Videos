---
title: "Statistics with R"
subtitle: "Introduction to R for Actuarial Students"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(magrittr)
library(knitr)
library(dplyr)
library(janitor)


```

```{css, echo=FALSE}
pre {
  background: #ADD8E6;
  max-width: 100%;
  overflow-x: scroll;
}
```

* Introduction to R for Actuarial Students

* CS1B Curriculum

* Introduction to R programming
* Fundamentals of Statistical Analysis

* Question 1
---

Q. 2) As per a recent research, the maximum systolic blood pressure for a person is related to age and
can be expressed in terms of the following equation:
maximum systolic blood pressure = 100 + age (in years)
i) If we decide to fit a regression line with maximum systolic blood pressure as the response
variable (Y) and age as the explanatory variable (X), what should be the values of the
regression coefficients Î± and Î² in light of the above equation? (2)
Suppose this is to be empirically proven and 20 people of varying ages are tested for their
maximum systolic blood pressure. The following data has been collected:
Age (X) Maximum Systolic
Blood Pressure (Y)
Age (X) Maximum Systolic
Blood Pressure (Y)
28 132 60 149
37 140 55 154
41 155 29 117
52 160 43 146
57 167 36 142
49 148 50 168
38 128 34 144
25 131 40 156
23 118 26 114
48 139 33 133
The data of age in years (X) and corresponding maximum systolic blood pressure (Y) can be
entered in R using the below code:

```{r}
x=c(28, 37, 41, 52, 57, 49, 38, 25, 23, 48, 60, 55, 29, 43, 36, 50, 34, 40, 26, 33)
y=c(132, 140, 155, 160, 167, 148, 128, 131, 118, 139, 149, 154, 117, 146, 142, 168, 144, 156,
114, 133)
```

---

Enter the data in R by copying the above code.
ii) Prepare a scatter plot of the data and briefly comment on the same. (3)
Histogram of 1200 simulations of x1_bar
x1_bar
Frequency
0.830 0.832 0.834 0.836 0.838
0 50 100 150
Histogram of 1200 simulations of x2_bar
x2_bar
Frequency
0.162 0.164 0.166 0.168 0.170
0 50 100 150
Histogram of 1200 simulations of x3_bar
x3_bar
Frequency
0.494 0.496 0.498 0.500 0.502 0.504
0 50 100 150 200 250

---
iii)
Plot the fitted line for regression of Y on X.
(4)
iv)
Using anova function check whether the slope parameter is significant.
(3)
v)
Obtain a summary for the linear regression model fitted in part (iv) and clearly state the estimates for the values of the coefficients Î± and Î².
(3)
vi)
Test the veracity of the above equation as promulgated in the recent research, by referring to your answers in part (i) and part (v).
(2)
vii)
Calculate the sample Pearson correlation coefficient, sample Kendall correlation coefficient and sample Spearman correlation coefficient.
(3)
viii)
Comment on each method of calculating correlation coefficient and also comment on the sample correlation coefficients obtained in part (vii).
(4)
One of your colleagues says that there exists perfect positive correlation between age and maximum systolic blood pressure.
ix)
Perform a hypothesis test to test the above statement at 5% level of significance. You should state the null and alternate hypotheses, report the p-value of the test and arrive at a clear conclusion.(Hint: Use Pearson Method)
(6)

---

Solution 2:
(i)
The given equation is 
 Maximum Systolic Blood Pressure = 100 + Age (in years)
 It can be written as
 y = 100 + x
 y = 100 + 1*(x)
 y = Î± + Î²x
 ð›¼ = 100 ð‘Žð‘›ð‘‘ ð›½ = 1
 (2)

---
(ii)
> x=c(28, 37, 41, 52, 57, 49, 38, 25, 23, 48, 60, 55, 29, 43, 36, 50, 34, 40, 
26, 33)
> y=c(132, 140, 155, 160, 167, 148, 128, 131, 118, 139, 149, 154, 117, 146, 1
42, 168, 144, 156, 114, 133)
> plot(x,y) 
(1)
 
 (1)
The age in years(x) and the systolic blood pressure(y) are positively correlat
ed.

---

(iii) 
> lm.result=lm(y~x) (1)
> abline(lm(y~x)) (1)
 (2)
(4) 
(iv) 
>anova(lm.result)
 (1)
Analysis of Variance Table
Response: y
 Df Sum Sq Mean Sq F value Pr(>F) 
x 1 3082.9 3082.94 33.591 1.717e-05 ***
Residuals 18 1652.0 91.78 
---
Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1
 (1)
From the above, it is clear that the slope parameter is significant.


---

(1)
(3) 
(v) 
>summary(lm.result) (1)
Call:
lm(formula = y ~ x)
Residuals:
 Min 1Q Median 3Q Max
-15.485 -6.504 1.177 5.979 14.846
Coefficients:
 Estimate Std. Error t value Pr(>|t|) 
(Intercept) 96.4994 8.1460 11.846 6.21e-10 ***
x 1.1331 0.1955 5.796 1.72e-05 ***
---
Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1
Residual standard error: 9.58 on 18 degrees of freedom
Multiple R-squared: 0.6511, Adjusted R-squared: 0.6317
F-statistic: 33.59 on 1 and 18 DF, p-value: 1.717e-05 
 (1)
The value of the estimates of the co-efficient are
 Alpha(Î±) = 96.4994 Beta(Î²) = 1.1331 (1)
(3) 
(vi) The values of alpha and beta are expected to be 100 and 1 respectively a
s per (i). But empirical test results fetch the values as 96.4994 and 1.1331
respectively, which is close to the expected values of 100 and 1 respectively
. Hence when empirically tested, we find that the claim made by the research
about the maximum systolic blood pressure is valid.
 (2)
(vii) 
> cor(x,y,method="pearson")
[1] 0.8069094
 (1)
> cor(x,y,method="spearman")
[1] 0.8180451
 (1)
> cor(x,y,method="kendall")
[1] 0.6105263
 (1)
(3) 
(viii) 
 Pearsonâ€™s correlation co-efficient measures the strength of the linear r
elationship between the two variables, whereas Spearman Correlation method mea
sures the strength of monotonic but not necessarily linearity between two vari
ables.
 Since Spearman considers the rank than the actual values, the value of t
he coefficient is less affected by extreme values/outliers in the data than Pe
arsonâ€™s Correlation Coefficient. Hence it is more robust.
 Kendallâ€™s correlation coefficient is considered to have better statistical
properties when the data set is small and have more tied ranks, though it c
onsiders the relative values between the data set and not actual values.

Page 6 of 11
Generally, the value of Kendallâ€™s coefficient is lower than the Spearmanâ€™s
rank coefficient.
 Based on the sample correlation coefficients calculated in part (vii), we
conclude Spearman Rank Coefficient > Pearsonâ€™s Coefficient > Kendallâ€™s Coeffi
cient
 (4)
(ix) 
ð»0 : Ï = 1
ð»1 : Ï â‰  1 (1)
> cor.test(x,y,method="pearson") (1) 
Pearson's product-moment correlation
data: x and y
t = 5.7958, df = 18, p-value = 1.717e-05
alternative hypothesis: true correlation is not equal to 0
95 percent confidence interval:
0.5667661 0.9206793
sample estimates:
 cor
0.8069094 (1)
p-value is 1.717e-05 (1)
Since 95% confidence interval (0.5667661, 0.9206793) does not include
the value 1, there is sufficient evidence to reject the hypothesis that there
is perfect correlation between Age and Systolic Blood Pressure though there is
strong positive correlation between the age and systolic Blood Pressure.
(2)
(6) 