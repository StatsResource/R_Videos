---
title: "Statistics with R"
subtitle: "Introduction to R for Actuarial Students"
output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    lib_dir: libs
    nature:
      highlightStyle: github
      countIncrementalSlides: false
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(magrittr)
library(knitr)
library(dplyr)
library(janitor)


```

```{r xaringan-themer, include=FALSE, warning=FALSE}
library(xaringanthemer)
style_mono_accent_inverse(
  #base_color = "#3C989E")(
  base_color = "#1c5253",
  header_font_google = google_font("Josefin Sans"),
  text_font_google   = google_font("Montserrat", "300", "300i"),
  code_font_google   = google_font("Fira Mono")
)
```

```{css, echo=FALSE}
pre {
  background: #ADD8E6;
  max-width: 100%;
  overflow-x: scroll;
}
```
4 Consider a random variable, ğ‘‹, following a modified exponential distribution with
Cumulative Distribution Function (CDF):
ğ¹ôˆºğ‘¥ôˆ» ô€µŒ ô€µœ
0, ğ‘¥ ô€µ 0
1 ô€µ† expôˆºô€µ†ğœ†ğ‘¥ô€¬¶ôˆ», ğ‘¥ô€µ’0
(i) Plot the CDF ğ¹ôˆºğ‘¥ôˆ» as a function of ğ‘¥ for ğ‘¥ ô€µŒ 0, 0.1, 0.2, â€¦ ,9.9, 10 when
Î» ô€µŒ 0.2. [4]
(ii) Plot the density function ğ‘“ôˆºğ‘¥ôˆ» of ğ‘‹ as a function of ğ‘¥ for
ğ‘¥ ô€µŒ 0, 0.1, 0.2, â€¦ ,9.9, 10 when Î» ô€µŒ 0.2. [5]

---

A random sample of 100 values of X is provided in randomSample.Rdata.
Loading the sample data into R will generate a vector x with 100 values representing
the sample.
(iii) Calculate the value of the log likelihood function for the parameter Î» at the
point Î» ô€µŒ 0.2 based on this random sample. 
(iv) Plot the values of the log likelihood function for the parameter Î» based on the
sample in randomSample.Rdata. Your plot of the log likelihood function
must be for values of Î» ô€µŒ 0.01, 0.02, â€¦ , 0.99, 1. [7]
The maximum likelihood estimator for the parameter Î» based on a random sample
ğ‘‹ô€¬µ, â€¦ , ğ‘‹ô€¯‡ is given by:
Î»ô€· 
ô€µŒ
ğ‘
Î£ ğ‘‹ô€¯œ
ô€¯‡ ô€¬¶
ô€¯œô€­€ô€¬µ
(v) Estimate the value of Î» using the maximum likelihood estimator given above
and the sample in randomSample.Rdata. 
(vi) Comment on the plot in part (iv) and the estimate in part (v). 
[Total 24]
---â€“6

Q4
(i)
cdf
x = seq(0, 10, by = 0.1) 
lambda = 0.2 
F = 1-exp(- lambda * x^2) 
plot(x,F,main= "CDF of X") 
<p>
---


(ii) density
Differentiate ğ¹: ğ‘“(ğ‘¥)={0,ğ‘¥<02ğœ†ğ‘¥exp(âˆ’ğœ†ğ‘¥2),ğ‘¥â‰¥0 
x = seq(0, 10, by = 0.1)
d = 2 * lambda * x * exp(-lambda * x^2) 
plot(x,d,main="Density of X") 
<p>
---


(iii)
#log likelihood
load("randomSample.Rdata")
d = 2 * lambda * x * exp(-lambda * x^2) 
ll = sum(log(d)) 
ll # -139.7437 
(iv)
#log likelihood for 100 values of lambda
ll = 1:100 
lambda = 1:100
for (k in 1:100) { 
lambda[k] = 0.01 * k 
ll[k] = sum(log(2 * lambda[k] * x * exp(-lambda[k] * x^2)))} 
<p>
---

plot(lambda,ll,main="Log likelihood") 

(v)
N = length(x) # sample size 
lambda.hat = N/sum(x^2) 
lambda.hat # 0.191256 
(vi)
The plot of the log likelihood function shows a maximum near 0.2, which is the MLE. 
That is consistent with the estimate obtained in part (v). 
[Total 24]
Commentary:
(i) Well answered in general.
(ii) Mixed answers. A common issue was errors in the differentiation.
(iii) Well answered in general.
(iv) There were mixed answers here, with many candidates producing the correct plot, but
<p>
---

there were various errors in many cases.
(v) Well answered in general. A small number of candidates failed to square x.
(vi) Well answered in general.