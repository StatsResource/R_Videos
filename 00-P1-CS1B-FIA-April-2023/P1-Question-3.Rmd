---
title: "Statistics with R"
subtitle: "Introduction to R for Actuarial Students"
output:
  xaringan::moon_reader:
    lib_dir: libs
    nature:
      highlightStyle: github
      countIncrementalSlides: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(magrittr)
library(knitr)
library(dplyr)
library(janitor)


```

```{css, echo=FALSE}
pre {
  background: #ADD8E6;
  max-width: 100%;
  overflow-x: scroll;
}
```

* Introduction to R for Actuarial Students

* CS1B Curriculum

* Introduction to R programming
* Fundamentals of Statistical Analysis

* Question 3
---


3 The file <tt>heights.RData</tt> contains an R data frame (heights) that consists of a 
random sample of heights of mothers (mother.height), fathers 
(father.height) and their daughters (daughter.height) in inches. 

#### Exercises

(i) Draw a scatterplot for each pair of data. 
(ii) Comment on the relationships between the pairs of data by referring to the 
plots from part A. 
(iii) Fit a multiple linear regression model with the daughtersâ€™ height as the 
response variable and mothersâ€™ and fathersâ€™ height as the explanatory 
variables. Your answer should show a summary of the output and the fitted 
equation. 

---
(iv) Assess the effect of each explanatory variable on the dependent variable by 
referring to the R output from part C.  
(v) Plot the residuals of the model fitted in part (iii) using a graph that is 
appropriate for checking if the estimated errors are independent of the 
explanatory variables. 
(vi) Comment on the fit of the model by referring to the plot from part (v). 
A suggestion is made that when the motherâ€™s height is 61 inches and the fatherâ€™s 
height is 63 inches, their daughterâ€™s height should be 67.5 inches. 
(vii) Comment on whether this claim is likely by using an appropriate 95% 
predictive interval of the daughterâ€™s height based on the fitted model. 


---

Q3
(i) R code:
```{r}
plot(heights, main = "Scatterplot of the heights of the daughter, mother and father") 
```


---
(ii) The scatterplots suggest a (strong) positive and roughly linear relationship between mothersâ€™ and daughtersâ€™ height. 
The relationship between fathersâ€™ and daughtersâ€™ height seems weaker 
There is no association between mothersâ€™ and fathersâ€™ height. 

---
(iii) R code:

```{r}
mod1 = lm(daughter.height ~ mother.height + father.height) 
summary(mod1)
```

---

CS1B - Actuarial Statistics - Core Principles - April 2023 - Examinersâ€™ report
CS1B A2023 Â© Institute and Faculty of Actuaries
#Residuals:
# Min 1Q Median 3Q Max
#-3.8805 -0.6942 0.5915 0.8651 3.3138
#
#Coefficients:
# Estimate Std. Error t value Pr(>|t|)
#(Intercept) 7.4543 10.8804 0.685 0.503
#mother.height 0.7072 0.1289 5.488 4e-05 ***
#father.height 0.1636 0.1266 1.293 0.213
#---
#Signif. codes: 0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1
#
#Residual standard error: 1.94 on 17 degrees of freedom
#Multiple R-squared: 0.6752, Adjusted R-squared: 0.637
#F-statistic: 17.67 on 2 and 17 DF, p-value: 7.057e-05 
The fitted equation is
ğ‘¦ğ‘¦ô€·œ=7.454+0.707 ğ‘€ğ‘€ğ‘€ğ‘€ğ‘€ğ‘€â„ğ‘’ğ‘’ğ‘Ÿğ‘Ÿâ€²ğ‘ ğ‘  â„ğ‘’ğ‘’ğ‘’ğ‘’ğ‘’ğ‘’â„ğ‘¡ +0.164 ğ¹ğ¹ğ¹ğ¹ğ¹ â„ğ‘’ğ‘’ğ‘Ÿğ‘Ÿâ€²ğ‘ ğ‘  â„ğ‘’ğ‘’ğ‘’ğ‘’ğ‘’ğ‘’â„ğ‘¡ 

---

(iv) Motherâ€™s height has a positive 
significant positive effect on daughterâ€™s height (p-value = 4e-05). 
On the other hand, although daughtersâ€™ height also increases with fatherâ€™s height, 
the effect is not significant (p-value = 0.213). 
(v) R code:
```{r}
mod1.residuals = residuals(mod1)
# Or
```

```{r}
# mod1.residuals = resid(mod1)
mod1.fitted = fitted(mod1)
#Or
# mod1.fitted = fitted.values(mod1)
```

---

```{r}
plot(mod1.fitted,mod1.residuals, main = â€œResiduals of the fitted multiple regression modelâ€) 
````
Alternative code: plot(mod1,1)

---

(vi) There seem to be doubts about the assumption of constant variance, with residuals around fitted values 62-64 showing higher variation. 
Also, although there seems to be random variation around zero, there is a larger number of positive residuals, indicating possible underestimation. 
(vii) R code:

```{r}
newdata = data.frame(mother.height=61, father.height=63)
predict(mod1,newdata,interval="predict",level=0.95) 
```
The 95% prediction interval (56.4, 65.4) 
So, a daughterâ€™s height of 67.5 inches seems unlikely, based on the fitted model. 

---

---


Part (i): Well answered. A common error was not including annotations on the plot.
Part (ii): Overall well answered. Some candidates failed to identify all 3 relevant points of the relationships shown in the plots.
Part (iii): Well answered generally. A number of candidates failed to state the fitted equation.
Part (iv): Mixed answers. A common error was not referring explicitly to the p-values or the positive effect.
Part (v): Overall very well answered. A common error was plotting the residuals against an index, without reference to the explanatory variables or fitted values.
Part (vi): Mixed answers. In a number of cases comments were unclear, but most candidates provided some valid comments.
Part (vii): Well answered generally.

---